---
sds_version: gluster-3.8.3
valid_objects:
- volume
- brick
- peer
- snapshot

object_details:
  volume:
    enabled: True
    value: "/clusters/gluster/$cluster.id/volumes/$volume.id"
    attrs:
      volname:
        type: String
      stripe_count:
        type: Integer
      replica_count:
        type: Integer
      disperse_count:
        type: Integer
      redundancy_count:
        type: Integer
      transport:
        type: String
      brickdetails:
        type: Brick[]
      force:
        type: Boolean
      directory:
        type: String
      bitrot:
        type: Boolean
      scrub-frequency:
        type: Integer
      scrub-throttle:
        type: Integer

    atoms:
         create:
          enabled: True
          uuid: "3948920503203209532485032480543"
          flows: ["CreateGlusterVolume"]
          run: "tendrl.gluster_bridge.atoms.volume.create.Create"
          type: "create"
          pre_run : ["tendrl.gluster_bridge.atoms.<atom_name>.<boolean_function>1", ...]
          post_run: ["tendrl.gluster_bridge.atoms.<atom_name>.<boolean_function>1", ...]
          name: Create-Gluster-Volume
          outputs:
             - "A map of type {object.attr1 : {required: True}, object.attr2:{required: False}}}}"
          inputs:
            - {volname: {required: True}, type: {required: False}, status: {required: False}}
            - {transport: {required: False}, brickdetails: {required: True}}
            - {stripe_count: {required: True}}
          version: 0.0.1

         start:
          enabled: True
          uuid: "45948920503203209532485032480543"
          flows: ["CreateGlusterVolume", "StartGlusterVolume"]
          run: "tendrl.gluster_bridge.atoms.volume.create.Start"
          type: "start"
          pre_run : ["tendrl.gluster_bridge.atoms.<atom_name>.<boolean_function>1", ...]
          post_run: ["tendrl.gluster_bridge.atoms.<atom_name>.<boolean_function>1", ...]
          name: Start-Gluster-Volume
          outputs:
             - "A map of type {object.attr1 : {required: True}, object.attr2:{required: False}}}}"
          inputs:
            - {volname: {required: True}, force: {required: False}}
          version: 0.0.1
 
  brick:
    attrs:
      brickdetails:
        type: String
        value: etcd
        help: Details of the brick
      volname:
        type: String
        value: etcd
        help: Gluster volume name

  flows:
      CreateGluster:
        enabled: False
      CreateGlusterVolume:
        enabled: True
        tendrl_context: "A map of Tendrl flow level context items like cluster id,tendrl id etc"
        uuid: "12350340593049503803450"
        description: "Create Gluster Volume with given context/params"
        atoms: ["volume.atoms.create", "volume.atoms.start"]
        pre_run : ["tendrl.node_agent.atoms.<atom_name>.<boolean_function>1", ...]
                  #boolean returning pre/post conditions function list
        post_run: ["tendrl.node_agent.atoms.<atom_name>.<boolean_function>1", ...]
        run: "tendrl.gluster_bridge.flows.create_gluster_volume.CreateGlusterVolume"
        type: Create
        outputs:
          - "A map of type {object.attr1 : {required: True}, object.attr2:{required: False}}"
        inputs:
          - "An immutable {object1.attr1 : {value: cluster1}, object.attr2:{value: 123}}"
        version: "0.0.1"
